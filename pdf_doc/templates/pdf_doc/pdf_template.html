<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title>{{ document.title }}</title>
    <style type="text/css">
        @page {
            size: a4 portrait;
            margin: 2cm;
            @frame footer {
                -pdf-frame-content: footerContent;
                bottom: 1cm;
                margin-left: 2cm;
                margin-right: 2cm;
                height: 1cm;
            }
        }
        body {
            font-family: Arial, Helvetica, sans-serif;
            font-size: 12pt;
            color: #000000;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .title {
            font-size: 24pt;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .office-name {
            font-size: 16pt;
            margin-bottom: 5px;
        }
        .date {
            font-size: 12pt;
            margin-bottom: 20px;
        }
        .section {
            margin: 20px 0;
        }
        .section-title {
            font-weight: bold;
            font-size: 14pt;
            margin-bottom: 10px;
            border-bottom: 1px solid #000;
            padding-bottom: 5px;
        }
        .signature-section {
            margin-top: 50px;
            page-break-inside: avoid;
        }
        .signature-table {
            width: 100%;
            border-collapse: collapse;
        }
        .signature-table td {
            width: 50%;
            text-align: center;
            padding: 10px;
        }
        .signature-line {
            border-top: 1px solid #000;
            margin-top: 40px;
            padding-top: 5px;
        }
        .status-badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 3px;
            font-size: 10pt;
        }
        .status-pending { background-color: #ffc107; }
        .status-accepted { background-color: #28a745; color: white; }
        .status-rejected { background-color: #dc3545; color: white; }
    </style>
</head>
<body>
    <div class="header">
        <div class="title">{{ document.title }}</div>
        <div class="office-name">{{ document.office_name }}</div>
        <div class="date">{{ document.date|date:"F d, Y" }}</div>
    </div>

    <div class="receiver">
        <strong>To:</strong> {{ document.receiver }}
    </div>

    <div class="section">
        <div class="section-title">Description</div>
        <div>{{ document.description|linebreaks }}</div>
    </div>

    <div class="section">
        <div class="section-title">Summary</div>
        <div>{{ document.summary|linebreaks }}</div>
    </div>

    <div class="section">
        <div class="section-title">Object</div>
        <div>{{ document.object|linebreaks }}</div>
    </div>

    <div class="signature-section">
        <table class="signature-table">
            <tr>
                <td>
                    <div class="signature-line">
                        {{ document.created_by.get_full_name|default:document.created_by.username }}
                    </div>
                    <div>Created By</div>
                </td>
                {% if document.accepted_by %}
                <td>
                    <div class="signature-line">
                        {{ document.accepted_by.get_full_name|default:document.accepted_by.username }}
                    </div>
                    <div>Approved By</div>
                </td>
                {% endif %}
            </tr>
        </table>
    </div>

    <div id="footerContent">
        <table width="100%">
            <tr>
                <td>Generated on: {{ generated_date|date:"F d, Y H:i" }}</td>
                <td style="text-align: right;">Page <pdf:pagenumber> of <pdf:pagecount></td>
            </tr>
        </table>
    </div>
</body>
</html>